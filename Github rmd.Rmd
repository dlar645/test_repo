---
title: "Github rmd"
author: "Dylan Larsen"
output:
  html_document:
    df_print: paged
---


```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(moderndive)
library(tidyverse)
library(fivethirtyeight)
```



### Exercise 4.1

```{r}
data("hiphop_cand_lyrics")

lyrics<-hiphop_cand_lyrics
```


(@)

```{r}
head(lyrics)
```
**The cases are individual songs.**

(@)


```{r}
dim(lyrics)
```

**There are 377 songs in this dataset.**

(@)

```{r}
names(lyrics)
```


### Exercise 4.2

```{r}
lyrics %>%
  count(candidate)

ggplot(lyrics, aes(x=candidate))+
  geom_bar(fill="green")+
  labs(x="Candidate", y="Totals")
```

**The biggest thing to take away is that the two major presidential candidates (Trump and Clinton) were far and away the most referenced people in hip hop songs.**

### Exercise 4.3

```{r}
ggplot(lyrics, aes(x=album_release_date))+
  geom_histogram(fill="blue", binwidth=2, color="white")+
  labs(x="Album Release Date")

ggplot(lyrics, aes(x=album_release_date))+
  geom_density(fill="black")+
  labs(x="Album Release Date")
```


**These graphs show that the number of albums released in this dataset increase as we get closer to the 2016 election. In general, the majority of the albums have been released since 2005*


### Exercise 4.4

```{r}

median(lyrics$album_release_date)
mean(lyrics$album_release_date)

ggplot(lyrics, aes(x=album_release_date))+
  geom_density(fill="green", alpha=.5)+
  labs(x="Album Release Date", title="Density plot of politic hiphop")+
  geom_vline(xintercept = 2011, color="black")+
  geom_vline(xintercept = 2008.459, color="blue")

```

### Exercise 6.1

```{r}
hotdogs <- read_csv("http://datasets.flowingdata.com/hot-dog-contest-winners.csv")

colnames(hotdogs)[colnames(hotdogs)=="Dogs eaten"]<-"Dogs_eaten"
```

**So, the response variable is dogs eaten**

```{r}
ggplot(hotdogs, aes(x=Year, y=Dogs_eaten))+
  geom_point()+
  geom_smooth(method="lm")
```

**It looks like the number of hot dogs eaten by each year tends to be more than the previous year. There seems to be two separate trends as there is a sharp increase from 2000 to 2001 where the dogs eaten almost doubled.**


### Exercise 6.2
```{r}
hotdogsSub <- hotdogs %>% 
    filter(Country %in% c("Japan","United States"))

ggplot(hotdogsSub, aes(x=Dogs_eaten, fill=Country, alpha=.5))+
  geom_density()
```
```{r}
ggplot(hotdogsSub, aes(x=Dogs_eaten, fill=Country, alpha=.5))+
  geom_density()+
  facet_wrap(~Country)
```

```{r}
ggplot(hotdogsSub, aes(x=Dogs_eaten, fill=Country, alpha=.5))+
  geom_histogram(bins=25)+
  facet_wrap(~Country)
```
**What we see is that the US winners are bimodal, with either extremely high winning values, or relatively low winning values, where Japan ocupies much of the middle winning hot dog totals.**

### Exercise 6.3

```{r}

data(bechdel)
ggplot(bechdel, aes(x=budget_2013, y=domgross_2013))+
  geom_point()+
  geom_smooth(method="lm")+
  labs(x="Movie Budget", y="Box Office Revenue")
```

*B*) **There seems to be a positive trend between budget size and box office returns, meaning the more money put into a movie, the more money will come back out. There are a couple outliers that could be skewing the results. One with a super high budget, but not a super high return, and one with a lower budget, but with really high returns.**

```{r}
ggplot(bechdel, aes(x=budget_2013, fill=clean_test, alpha=.4))+
  geom_density()+
  labs(x="Bechdel Test", y="Movie Budget")+
  facet_wrap(~clean_test)
```

*D*) **One thing that stands out is that the movies that passed the bechdel test had generally lower budgets than the movies that didn't. You can see this with the high spike on the lower end of the budgets for the ok density plot. the other plots, which represent failures are more spread out representing higher budgets.**


### Exercise 6.4

*A*) **The proportion of movies that passed the bechdel test has risen, although not linearly, as it has kind of plateaud in recent years. It seemed that all movies had women in the first time period, but a ton of them didn't talk to eachother, no movies failed because of the dubious or that there were no women. The no talking reason is still the largest reason movies fail today, but not by as big of a margin in previous years.**

```{r}
newbechdel <- bechdel %>% 
  mutate(clean_test=factor(clean_test, c("nowomen","notalk","men","dubious","ok"))) %>% 
  mutate(yearCat=cut(year, breaks=seq(1969,2014,by=5)))
  
ggplot(newbechdel, aes(x=yearCat, fill=clean_test))+
  geom_bar(position="fill")+
  scale_fill_manual(values = c("red","salmon","pink","steelblue1","steelblue4"))
```

